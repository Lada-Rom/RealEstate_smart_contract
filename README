# Smart Contract

Задание №1. Блокчейн. НИТУ МИСиС весна 2023.

## Бизнес-логика

> Назначение смарт-контракта, представленного в репозитории, регулирование купли-продажи недвижимости с использованием технологии блокчейн.  

Владельцы недвижимости могут выставить на продажу ***своё*** имущество, зарегистрированное в [Росреестре][rosreestr], в виде **невзаимозаменяемого токена**. Для проведения транзакции каждый пользователь обязан верифицироваться с использованием аккаунта на портале [Госуслуг РФ][gosuslugi]. Любой *верифицированный* пользователь (кроме самого владельца) может подать запрос на приобретение недвижимости. В случае одобрения покупки со стороны продовца происходит автоматический перевод денежных средств (криптовалюты) на кошелёк покупателя, а право владения токена, который является цифровым представлением имущества, переходит к покупателю.

## Алгоритм купли-продажи  

На примере продажи Здания А, инициированной Продавцом (с адресом в блокчейне `0x5B3...dC4`), рассмотрим алгоритм действий Покупателя (с адресом в блокчейне `0xAb8...cb2`).  

#### Нулевой шаг

Создание токена (цифрового представления имущества) инициируется Продавцом, который проводит транзакцию, например, со следующими параметрами:
```cpp
// документ на имущетсво, стоимость (вей), логин (Госуслуги), пароль (Госуслуги)
constructToken("ipfs://property_doc.pdf", 1000, "owner", "owner") 
```
В случае успешной транзакции будет выведено сообщение следующего вида  
![](docs/step_0.jpeg)

#### Первый шаг

Для покупки недвижимости Покупатель обязан пройти этап верификации (например, со следующими параметрами):
```cpp
// логин (Госуслуги), пароль (Госуслуги)
verifyMe("buyer", "buyer")
```
В случае успешной транзакции будет выведено сообщение следующего вида  
![](docs/step_1.jpeg)

#### Второй шаг

После выбора интересующей Покупателя недвижимости, необходимо запросить (каким-либо образом) разрешение на покупку у Продавца, иначе при попытке купить имущество 
```cpp
// адрес Продавца, адрес Покупателя, номер токена (недвижимости) в блокчейне 
safeTransactionFrom(0x5B3...dC4, 0xAb8...cb2, 1)
```
будет выведено сообщение следующего вида  
![](docs/step_2_0.jpeg)

Продавец может выдать согласие на покупку следющим образом:
```cpp
// адрес Покупателя, номер токена (недвижимости) в блокчейне 
approve(0xAb8...cb2, 1)
```
вывод  
![](docs/step_2_1.jpeg)

После получения одобрения на покупку Покупатель может приобрести токен (недвижимость)
```cpp
// адрес Продавца, адрес Покупателя, номер токена (недвижимости) в блокчейне 
safeTransactionFrom(0x5B3...dC4, 0xAb8...cb2, 1)
```
результат транзакции
![](docs/step_2_2.jpeg)

## Запуск

Для тестирования корректной сборки проекта, пожалуйста, запустите тесты `realestate.test.js`. При корректной сборке результат будет как на фото ниже
![](docs/tests.jpeg)

## Авторы 

Клейменов А.А., МПИ-22-1
Толстенко Л.С., МПИ-22-1

[//]: # (links)
[rosreestr]: <https://rosreestr.gov.ru>
[gosuslugi]: <https://www.gosuslugi.ru>
